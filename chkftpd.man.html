<h2 id="heading1">NAME</h2>
<p class="indent">
<b><a href="./scripts.php?script=chkftpd">chkftpd</a></b>
- checks remote ftpd logs for dropped links and refused ports, if problems
are found the scripts raises alerts
and starts 
<b>tcpdump</b>
on the remote host.
</p>
<h2 id="heading2">SYNOPSIS</h2>
<p class="indent">

<b><a href="./scripts.php?script=chkftpd">chkftpd</a></b>
 [
<b>-c</b>
<i> &lt;client host&gt;</i>
] [
<b>-d</b>
] [
<b>-e</b>
<i> &lt;mail rcpt&gt;</i>
]
[
<b>-l</b>
] [
<b>-r </b>
<i>&lt;runtime(secs)</i>
] [
<b>-t</b>
] [
<b>-T </b>
<i>&lt;sms number&gt;</i>
]
[
<b>-v</b>
] 
<i>&lt;hostname&gt;</i>
 | 
<b>-h</b>

.b
r
</p>
<h2 id="heading3">AVAILABILITY</h2>
<p class="indent">
<b><a href="./scripts.php?script=chkftpd">chkftpd</a></b>
is a Bourne shell script which should work equally well on all versions of UNIX,
Mac OSX and Linux.
</p>
<h2 id="heading4">DESCRIPTION</h2>
<p class="indent">
<b><a href="./scripts.php?script=chkftpd">chkftpd</a></b>
checks the ftpd logs on a remote host. If problems are found then the
systems operators are notified by e-mail and optionally by SMS text message.
<b>Tcpdump</b>
is started on the remote host and attempts to record relevant network
packets for later analysis.
</p>
<h2 id="heading5">OPTIONS</h2>
<p class="indent">
</p>
<p class="indent">

<b>-c </b>
<i>&lt;client host&gt;</i>

Use the ftp 
<i>client host</i>
name or IP to filter packets collected by 
<b>tcpdump .</b>
</p>
<p class="indent">
<b>-d </b>
Switch to debug mode. 
</p>
<p class="indent">

<b>-e </b>
<i>&lt;e-mail address&gt;</i>

Use 
<i>email address</i>
 for alerts in preference to the default
hard coded in the script.
</p>
<p class="indent">
<b>-h</b>&nbsp;&nbsp;&nbsp;
if used on its own the manual page is invoked. Using 
<b>-h</b>&nbsp;&nbsp;&nbsp;
in combination with other options is an error. The command syntax is 
printed to 
<i>standard error</i>
and the script terminates.
</p>
<p class="indent">
<b>-l</b>&nbsp;&nbsp;&nbsp;
Use the system logging facility to log the start of
<b><a href="./scripts.php?script=chkftpd">chkftpd</a></b>
and again to log the identification of a problem.
</p>
<p class="indent">
<b>"-r #"</b>
Set the duration, in seconds for which 
<b>tcpdump</b>
will run. The default value is 120 seconds.
</p>
<p class="indent">
<b>-t </b>
Put 
<b><a href="./scripts.php?script=chkftpd">chkftpd</a></b>
in test mode. Alerts will be sent regardless of whether or not problems are
detected.
</p>
<p class="indent">

<b>-T </b>
<i>&lt;phone number&gt;</i>

Send SMS text alerts to 
<i>phone number</i>
<i></i>
</p>
<p class="indent">
<b>-v</b>&nbsp;&nbsp;&nbsp;
Set verbose mode. Ordinarily 
<b><a href="./scripts.php?script=chkftpd">chkftpd</a></b>
operates silently unless problems are detected. In 
<i>verbose</i>
mode 
<b><a href="./scripts.php?script=chkftpd">chkftpd</a></b>
reports on every significant action.
</p>
<h2 id="heading6">EXAMPLES</h2>
<p class="indent">
</p><div class="cmdline">
<pre>
chkftpd -c 10.0.0.3 -r 300 -T 01159999999 -e user@addr.com
</pre></div>
<p class="indent">
</p>
<p class="indent">
Check the ftpd logs on host qsl. If problems are detected notify 
user@addr.com, text 0115 599 9999 and run tcpdump for 5 
minutes filtering for packets to or from 10.0.0.3.

</p>
<h2 id="heading8">BUGS</h2>
<p class="indent">
The script is quite crude having been developed to address problems experienced
by a City Linux client running CentOS servers at 1and1 in Germany. It does
depend on very specific file and remote access permissions. Particularly it
expects that where root permission is required 
<b>sudo</b>
will be used. With judicious use of the 
<i>debug</i>
and
<i>verbose </i>
modes, permission and configuration problems should be relatively easy to 
resolve.

Currently
<b>chkftpd</b>
is looking for dropped links and refused PORTS, it also expects to receive
the symbolic name or ip of the ftp client host involved and passes this to
<b>tcpdump .</b>
If the 
<b>-c</b>
option is not used the Behaviour is uncertain.


</p>
<h2 id="heading9">SEE ALSO</h2>
<p class="indent">
<a href="./scripts.php?script=chkdf&amp;man=y"><i>chkdf</i>,</a>
<a href="./scripts.php?script=chkfw&amp;man=y"><i>chkfw</i>,</a>
<a href="./scripts.php?script=clean&amp;man=y"><i>clean</i>,</a>
<a href="./scripts.php?script=secscan&amp;man=y"><i>secscan</i>.</a>
</p>
<h2 id="heading10">AUTHOR</h2>
<p class="indent">
Clifford W Fulford, City Linux. Contact fulford@fulford.net or +44 (0)709 229 5385.
</p>
	
